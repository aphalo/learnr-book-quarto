<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Learn R: As a Language - Second edition (2024)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./r4p-favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Learn R: As a Language</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-book" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Book</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-book">    
        <li>
    <a class="dropdown-item" href="./contents-2ed.html"><i class="bi bi-list-columns" role="img">
</i> 
 <span class="dropdown-text">Contents (2ed)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./preface-2ed.html"><i class="bi bi-book" role="img">
</i> 
 <span class="dropdown-text">Preface (2ed)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./contents-1ed.html"><i class="bi bi-list-columns" role="img">
</i> 
 <span class="dropdown-text">Contents (1ed)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./preface-1ed.html"><i class="bi bi-book" role="img">
</i> 
 <span class="dropdown-text">Preface (1ed)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-code" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-paperclip" role="img">
</i> 
 <span class="menu-text">R code</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-code">    
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/learnrbook/"><i class="bi bi-box-seam" role="img">
</i> 
 <span class="dropdown-text">‘learnrbook’ package</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./wordcloud.html"><i class="bi bi-file" role="img">
</i> 
 <span class="dropdown-text">Wordcloud (cover)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-also-by-the-author" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-folder2-open" role="img">
</i> 
 <span class="menu-text">Also by the author</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-also-by-the-author">    
        <li>
    <a class="dropdown-item" href="https://www.r4photobiology.info/r-index.html"><i class="bi bi-file-richtext" role="img">
</i> 
 <span class="dropdown-text">Web pages on R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.r4photobiology.info/"><i class="bi bi-journals" role="img">
</i> 
 <span class="dropdown-text">Packages (HTML documentation)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://aphalo.r-universe.dev/"><i class="bi bi-rocket-takeoff" role="img">
</i> 
 <span class="dropdown-text">Packages (at R-Universe)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> <i class="bi bi-person" role="img">
</i> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/aphalo/learnr-book-crc"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-book" id="toc-the-book" class="nav-link active" data-scroll-target="#the-book"><span class="header-section-number">1</span> The Book</a>
  <ul class="collapse">
  <li><a href="#book-citation" id="toc-book-citation" class="nav-link" data-scroll-target="#book-citation">Book citation</a></li>
  </ul></li>
  <li><a href="#the-chapters" id="toc-the-chapters" class="nav-link" data-scroll-target="#the-chapters"><span class="header-section-number">2</span> The Chapters</a>
  <ul class="collapse">
  <li><a href="#preface" id="toc-preface" class="nav-link" data-scroll-target="#preface">Preface</a></li>
  <li><a href="#using-the-book-to-learn-r" id="toc-using-the-book-to-learn-r" class="nav-link" data-scroll-target="#using-the-book-to-learn-r">1. Using the Book to Learn R</a></li>
  <li><a href="#r-the-language-and-the-program" id="toc-r-the-language-and-the-program" class="nav-link" data-scroll-target="#r-the-language-and-the-program">2. R: The language and the program</a></li>
  <li><a href="#base-r-words-and-sentences" id="toc-base-r-words-and-sentences" class="nav-link" data-scroll-target="#base-r-words-and-sentences">3. Base R: “Words” and “Sentences”</a></li>
  <li><a href="#base-r-collective-nouns" id="toc-base-r-collective-nouns" class="nav-link" data-scroll-target="#base-r-collective-nouns">4. Base R: “Collective Nouns”</a></li>
  <li><a href="#base-r-paragraphs-and-essays" id="toc-base-r-paragraphs-and-essays" class="nav-link" data-scroll-target="#base-r-paragraphs-and-essays">5. Base R: “Paragraphs” and “Essays”</a></li>
  <li><a href="#base-r-adding-new-words" id="toc-base-r-adding-new-words" class="nav-link" data-scroll-target="#base-r-adding-new-words">6. Base R: Adding New “Words”</a></li>
  <li><a href="#base-r-verbs-and-nouns-for-statistics" id="toc-base-r-verbs-and-nouns-for-statistics" class="nav-link" data-scroll-target="#base-r-verbs-and-nouns-for-statistics">7. Base R: “Verbs” and “Nouns” for Statistics</a></li>
  <li><a href="#r-extensions-data-wrangling" id="toc-r-extensions-data-wrangling" class="nav-link" data-scroll-target="#r-extensions-data-wrangling">8. R Extensions: Data Wrangling</a></li>
  <li><a href="#r-extensions-grammar-of-graphics" id="toc-r-extensions-grammar-of-graphics" class="nav-link" data-scroll-target="#r-extensions-grammar-of-graphics">9. R Extensions: Grammar of Graphics</a></li>
  <li><a href="#base-r-and-extensions-data-sharing" id="toc-base-r-and-extensions-data-sharing" class="nav-link" data-scroll-target="#base-r-and-extensions-data-sharing">10. Base R and Extensions: Data Sharing</a></li>
  </ul></li>
  <li><a href="#free-supplementary-material" id="toc-free-supplementary-material" class="nav-link" data-scroll-target="#free-supplementary-material"><span class="header-section-number">3</span> Free supplementary material</a></li>
  <li><a href="#issues" id="toc-issues" class="nav-link" data-scroll-target="#issues"><span class="header-section-number">4</span> Issues</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Second edition (2024)</h1>
<p class="subtitle lead">Contents and chapter summaries</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.routledge.com/Learn-R-As-a-Language/Aphalo/p/book/9781032516998"><img src="images/front-cover-2ed.png" title="The book cover" class="img-fluid figure-img" style="width:40.0%" alt="The book cover"></a></p>
<figcaption>The book cover</figcaption>
</figure>
</div>
<section id="the-book" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> The Book</h1>
<p>Learn <em>R: As a Language</em> (2ed) was authored by Pedro J. Aphalo and published in 2024 in the <em>The R Series</em> by Chapman and Hall/CRC.</p>
<section id="book-citation" class="level2">
<h2 class="anchored" data-anchor-id="book-citation">Book citation</h2>
<p>Aphalo, Pedro J. (2024) <em>Learn R: As a Language,</em> 2 ed.&nbsp;Boca Raton: CRC/Taylor &amp; Francis Ltd (The R Series), 466 pp.&nbsp;ISBN: 9781032516998. (466 pages, 191 color illustrations.)</p>
<pre><code>@Book{Aphalo2020,
  author    = {Pedro J. Aphalo},
  date      = {2024},
  title     = {Learn R: As a Language},
  edition   = {2},
  isbn      = {9781032516998},
  pagetotal = {466},
  publisher = {CRC/Taylor &amp; Francis Ltd},
  series    = {The R Series},
}</code></pre>
</section>
</section>
<section id="the-chapters" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> The Chapters</h1>
<section id="preface" class="level2">
<h2 class="anchored" data-anchor-id="preface">Preface</h2>
</section>
<section id="using-the-book-to-learn-r" class="level2">
<h2 class="anchored" data-anchor-id="using-the-book-to-learn-r">1. Using the Book to Learn R</h2>
<p>In this chapter, I describe how I imagine the book can be used most effectively to learn the R language. Learning R and remembering what one has previously learnt and forgotten makes it also necessary to use this book and other sources as references. Learning to use R effectively also involves learning how to search for information and how to ask questions from other users, for example through online forums. Thus, I also give advice on how to find answers to R-related questions and how to use the available documentation.</p>
</section>
<section id="r-the-language-and-the-program" class="level2">
<h2 class="anchored" data-anchor-id="r-the-language-and-the-program">2. R: The language and the program</h2>
<p>I share some facts about the history and design of the R language so that you can gain a good vantage point from which to grasp the logic behind R’s features, making it easier to understand and remember them. You will learn the distinction between the R program itself and the front-end programs, like RStudio, frequently used together with R.</p>
<p>You will also learn how to interact with R when sitting at a computer. You will learn the difference between typing commands interactively and reading each partial result from R on the screen as you enter them, versus using R scripts containing multiple commands stored in a file to execute or run a “job” that saves results to another file for later inspection.</p>
<p>I describe the steps taken in a typical scientific or technical study, including the data analysis workflow and the roles that R can play in it. I share my views on the advantages and disadvantages of textual command languages such as R compared to menu-driven user interfaces, frequently used in other statistics software. I discuss the role of textual languages and literate programming in the very important question of the reproducibility of data analyses and mention how I have used them while writing and typesetting this book.</p>
</section>
<section id="base-r-words-and-sentences" class="level2">
<h2 class="anchored" data-anchor-id="base-r-words-and-sentences">3. Base R: “Words” and “Sentences”</h2>
<p>In my experience, for those who are not familiar with computer programming languages, the best first step in learning the R language is to use it interactively by typing textual commands at the R console. This teaches not only the syntax and grammar rules, but also gives a glimpse at the advantages and flexibility of this approach to data analysis. In this chapter, I focus on the different simple values or items that can be stored and manipulated in R, as well as the role of computer program statements, the equivalent of “sentences” in natural languages.</p>
<p>In the first part of the chapter, you will use R to do everyday calculations that should be so easy and familiar that you will not need to think about the operations themselves. This easy start will give you a chance to focus on learning how to issue textual commands at the command prompt.</p>
<p>Later in the chapter, you will gradually need to focus more on the R language and its grammar and less on how commands are entered. By the end of the chapter, you will be familiar with most of the kinds of simple “words” used in the R language and you will be able to read and write simple R statements.</p>
<p>Throughout the chapter, I will occasionally show the equivalent of the R code in mathematical notation. If you are not familiar with the mathematical notation, you can safely ignore the mathematics, as long as you understand the diagrams and the R code.</p>
</section>
<section id="base-r-collective-nouns" class="level2">
<h2 class="anchored" data-anchor-id="base-r-collective-nouns">4. Base R: “Collective Nouns”</h2>
<p>Data set organisation and storage is one of the keys to efficient data analysis. How to keep together all the information that belongs together, say all measurements from an experiment and corresponding metadata such as treatments applied and/or dates. The title “collective nouns” is based on the idea that a data set is a collection of data objects.</p>
<p>In this chapter, you will familiarise with how data sets are usually managed in R. I use both abstract examples to emphasise the general properties of data sets and the R classes available for their storage and a few more specific examples to exemplify their use in a more concrete way. While in chapter 3 the focus was on atomic data types and objects, like vectors, useful for the storage of collections of values of a given type, like numbers, in the present chapter the focus is on the storage within a single object of heterogeneous data, such as a combination of factors, and character and numeric vectors. Broadly speaking, heterogeneous data containers.</p>
<p>To describe the structure of R objects I use diagrams similar to those in the previous chapter.</p>
</section>
<section id="base-r-paragraphs-and-essays" class="level2">
<h2 class="anchored" data-anchor-id="base-r-paragraphs-and-essays">5. Base R: “Paragraphs” and “Essays”</h2>
<p>For those who have mainly used graphical user interfaces, understanding why and when scripts can help in communicating a certain data analysis protocol can be revelatory. As soon as a data analysis stops being trivial, describing the steps followed through a system of menus and dialogue boxes becomes extremely tedious. Moreover, graphical user interfaces tend to be difficult to extend or improve in a way that keeps step-by-step instructions valid across program versions and operating systems.</p>
<p>Many times, exactly the same sequence of commands needs to be applied to different data sets, and scripts make both implementation and validation of such a requirement easy.</p>
<p>In this chapter, I will walk you through the use of R scripts, starting from an extremely simple script.</p>
</section>
<section id="base-r-adding-new-words" class="level2">
<h2 class="anchored" data-anchor-id="base-r-adding-new-words">6. Base R: Adding New “Words”</h2>
<p>In earlier chapters we have only used base R features. In this chapter you will learn how to expand the range of features available. I start by discussing how to define and use new functions, operators, and classes. What are their semantics and how they contribute to conciseness and reliability of computer scripts and programs. Later I focus on using existing packages to share extensions to R and touch briefly on how they work. I do not consider the important, but more advanced question of packaging functions and classes into new R packages. Instead I discuss how packages are installed and used.</p>
</section>
<section id="base-r-verbs-and-nouns-for-statistics" class="level2">
<h2 class="anchored" data-anchor-id="base-r-verbs-and-nouns-for-statistics">7. Base R: “Verbs” and “Nouns” for Statistics</h2>
<p>This chapter aims to give the reader an introduction to the approach used in base R for the computation of statistical summaries, the fitting of models to observations and tests of hypothesis. This chapter does not explain data analysis methods, statistical principles or experimental designs. There are many good books on the use of R for different kinds of statistical analyses (see further reading on page 241) but most of them tend to focus on specific statistical methods rather than on the commonalities among them. Although base R’s model fitting functions target specific statistical procedures, they use a common approach to model specification and for returning the computed estimates and test outcomes. This approach, also followed by many contributed extension packages, can be considered as part of the philosophy behind the R language. In this chapter, you will become familiar with the approaches used in R for calculating statistical summaries, generating (pseudo-)random numbers, sampling, fitting models, and carrying out tests of significance. We will use linear correlation, t-test, linear models, generalised linear models, non-linear models, and some simple multivariate methods as examples. The focus is on how to specify statistical models, contrasts and observations, how to access different components of the objects returned by the corresponding fit and summary functions, and how to use these extracted components in further computations or for customised printing and formatting.</p>
</section>
<section id="r-extensions-data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="r-extensions-data-wrangling">8. R Extensions: Data Wrangling</h2>
<p>Base R and the recommended extension packages (installed by default) include many functions for manipulating data. The R distribution supplies a complete set of functions and operators that allow all the usual data manipulation operations. These functions have stable and well-described behaviour, so in my view, they should be preferred unless some of their limitations justify the use of alternatives defined in contributed packages. In the present chapter, I describe the new syntax introduced by the most popular contributed R extension packages aiming at changing (usually improving one aspect at the expense of another) in various ways how we can manipulate data in R. These independently developed packages extend the R language not only by adding new “words” to it but by supporting new ways of meaningfully connecting “words”—i.e., providing new “grammars” for data manipulation. While at the current stage of development of base R not breaking existing code has been the priority, several of the still “young” packages in the ‘tidyverse’ have prioritised experimentation with enhanced features over backwards compatibility. The development of ‘tidyverse’ packages seems to have initially emphasised users’ convenience more than encouraging safe/error-free user code. The design of package ‘data.table’ has prioritised performance at the expense of easy of use. I do not describe in depth these new approaches but instead only briefly compare them to base R highlighting the most important differences.</p>
</section>
<section id="r-extensions-grammar-of-graphics" class="level2">
<h2 class="anchored" data-anchor-id="r-extensions-grammar-of-graphics">9. R Extensions: Grammar of Graphics</h2>
<p>Three main data plotting systems are available to R users: base R, package ‘lattice’ (Sarkar 2008), and package ‘ggplot2’ (Wickham and Sievert 2016); the last one being the most recent and currently most popular system available in R for plotting data. Even two different sets of graphics primitives (i.e., those used to produce the simplest graphical elements such as lines and symbols) are available in R, those in base R and a newer one in the ‘grid’ package (Murrell 2019).</p>
<p>In this chapter, you will learn the concepts of the layered grammar of graphics, on which package ‘ggplot2’ is based. You will also learn how to build several types of data plots with package ‘ggplot2’. As a consequence of the popularity and flexibility of ‘ggplot2’, many contributed packages extending its functionality have been developed and deposited in public repositories. However, I will focus mainly on package ‘ggplot2’ only briefly describing a few of these extensions.</p>
</section>
<section id="base-r-and-extensions-data-sharing" class="level2">
<h2 class="anchored" data-anchor-id="base-r-and-extensions-data-sharing">10. Base R and Extensions: Data Sharing</h2>
<p>In this chapter, you will learn how to exchange data between R and some other applications. Base R and the recommended packages (installed by default) include several functions for importing and exporting data. Contributed packages provide both replacements for some of these functions and support for several additional file formats. In the present chapter, I aim at describing both data input and output covering in detail only the most common “foreign” data formats (those not native to R). The function pairs save() and load(), and saveRDS() and readRDS(), which save and read data in R’s native formats, are described in chapter 4, sections 4.7.2 and 4.7.3 starting on page 118.</p>
<p>Data file formats that are foreign to R are not always well defined, making it necessary to reverse-engineer the algorithms needed to read them. These formats, even when clearly defined, may be updated by the developers of the foreign software that writes the files. Consequently, developing software to read and write files using foreign formats can easily result in long, messy, and ugly R scripts. We can also unwillingly write code that usually works but occasionally fails with specific files, or even worse, occasionally silently corrupts the imported data. The aim of this chapter is to provide guidance for finding functions for reading data encoded using foreign formats, covering both base R, including the ‘foreign’ package, and independently contributed packages. Such functions are well tested or validated and should be used whenever possible when importing data stored in foreign file formats.</p>
</section>
</section>
<section id="free-supplementary-material" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Free supplementary material</h1>
<p>For this second edition I provide the supplementary material as pages at <a href="https://www.r4photobiology.info/">my website</a>. A <a href="https://www.r4photobiology.info/r-index.html">custom contents page</a> makes it easier to find the relevant content, but other pages at the site may also be of interest to readers of the book.</p>
</section>
<section id="issues" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Issues</h1>
<p>Reports of errors and suggestions for enhancements of the book are welcome, preferably as Issues raised at <a href="https://github.com/aphalo/learnr-book-crc/issues" class="uri">https://github.com/aphalo/learnr-book-crc/issues</a>.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.learnr-book\.info\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0003-3385-972X">
<p>P. J. Aphalo @ ORCID</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Learn R: As a Language
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="./about.html">
<p>© 2015-2024 Pedro J. Aphalo</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>